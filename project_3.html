<html> 
  <head> 
    <title> Phebe's Coding Showcases </title>
    <script src = "https://cdn.jsdelivr.net/npm/p5@1.4.1/lib/p5.js"> </script>
    <link rel = "stylesheet" href = "project_2_style.css">
  </head>
  <body>
    <table class = "header-table">
      <tr class = "header-tr">
        <td class = "header-td">
          <a href = "index.html"> Home </a>
        </td>
        <td class = "header-td">
          <a href = "/project_1.html"> Project 1 </a>
        </td>
        <td class = "header-td">
          <a href = "/project_2.html"> Project 2 </a>
        </td>
        <td class = "header-td">
          <a href = "/project_3.html"> Project 3 </a>
        </td>
        <td class = "header-td">
          <a href = ""> Project 4 </a>
        </td>
      </tr>
    </table>
    <h1 style = "text-align: center;"> Infinite Runner </h1>
    <script>
      let page; let playerImg1; let playerImg2; let imgX; let scrollSpeed; let score; let birds; let bird; let player; let backgroundImg;
      var setup = function(){
          let cnv;
          if (windowWidth < windowHeight){
                  cnv = createCanvas(windowWidth - 20, windowWidth - 20);
          }
          else{
                  cnv = createCanvas(windowHeight - 20,  windowHeight - 20);
          }
          cnv.parent("canvas");
        imageMode(CENTER);
        page = 0;
        playerImg1 = loadImage("/mickey.png");
        playerImg2 = loadImage("/winnie.png");
        imgX = 0;
        scrollSpeed = 2;
        score = 0;
        player = {
            x : 100,
            y : 330,
            img : null,
            jumpTime : 0,
            jumping : false
        };
        bird = function() {
            this.x = random(430, 500);
            this.y = 330;
            this.image = loadImage("/hummingbirds.png");
            this.speed = random(-2, -5);
        };
        birds = [new bird()];
        backgroundImg = loadImage("/clouds-from-plan.png");
      };
      
      var drawBirds = function() {
          for (var i = 0; i < birds.length; i ++) {
              image(birds[i].image, birds[i].x, birds[i].y, 50, 50);
              birds[i].x += birds[i].speed;
              if (birds[i].x < -20) {
                  birds[i] = new bird();
                  score += 1;
              }
          }
      };

      var checkCollision = function() {
          for (var i = 0; i < birds.length; i ++) {
              var distance = dist(player.x, player.y, birds[i].x, birds[i].y);
              if (distance < 55) {
                  page = 2;
              }
          }
      };

      var startpage = function() {
          background(255);
          fill(255, 0, 0);
          rect(57, 61, 120, 70);
          rect(229, 61, 120, 70);
          fill(0);
          textSize(50);
          text("Play", 70, 116);
          text("Play", 243, 116);
          image(playerImg2, 111, 250, 100, 100);
          image(playerImg1, 300, 250, 100, 100);
      };

      var gamepage = function() {
          background(0);
          translate(imgX, 0);
          image(backgroundImg, 200, 200, 400, 400);
          resetMatrix();
          translate(imgX + 800, 0);
          scale(-1, 1);
          image(backgroundImg, 200, 200, 400, 400);
          resetMatrix();
          imgX -= scrollSpeed;
          if(imgX <= -400){
              imgX = 0;
          }
          image(player.img, player.x, player.y, 100, 100);
          jump();
          drawBirds();
          checkCollision();
          textSize(30);
          fill(0);
          text(score, 50, 50);
      };

      var endpage = function() {
          background(123, 245, 255);
          textSize(50);
          text("Game Over.", 70, 100);
          text("score:", 150, 170);
          textSize(100);
          text(score, 180, 250);
      };

      var jump = function() {
          if (player.jumping === true) {
              if(player.jumpTime > 59) {
                  player.jumping = false; 
              }
              else if (player.jumpTime > 29) {
                  player.y += 5;
              }
              else {
                  player.y -= 5;
              }
              player.jumpTime += 1;
          }
      };

      var convertX = function(num){
        return map(num, 0, 400, 0, width);
      };

      var convertY = function(num){
        return map(num, 0, 400, 0, height);
      };

      var draw = function() {
          if (page === 0){
              startpage();
          }
          else if (page === 1) {
              gamepage();
          }
          else if (page === 2) {
              endpage();
          }
      };

      var mouseClicked = function() {
          if(mouseX > 57 && mouseY > 61 && mouseX < 177 && mouseY < 131 && page === 0) {
              player.img = playerImg2;
              page = 1;
          }
          if(mouseX >229 && mouseY > 61 && mouseX < 349 && mouseY < 131 && page === 0) {
              player.img = playerImg1;
              page = 1;
          }
      };

      var keyPressed = function() {
          if (keyCode === 32) {
              if (player.jumping === false) {
                  player.jumping = true;
                  player.jumpTime = 0;
              }
          }
      };
    </script>
    <div id = "canvas"> </div>
    <h3> Description </h3>
    <p>
      First, choose your character. Press the space bar to jump so you do not collide with birds.
    </p>
  </body>
</html>
